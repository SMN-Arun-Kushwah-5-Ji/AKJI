#!/bin/bash

# ---------------- Colors ----------------
colors=("\033[1;31m" "\033[1;32m" "\033[1;33m" "\033[1;34m" "\033[1;35m" "\033[1;36m")
reset="\033[0m"
color_index=0

# ---------------- Banner ----------------
print_banner() {
  clear
  color_index=$(( (color_index + 1) % ${#colors[@]} ))
  width=64  # fixed width for centering

  # Function: print words with different colors
  multicolor_center() {
    local text="$1"
    local words=($text)
    local total_len=${#text}
    local pad=$(( (width - total_len) / 2 ))
    printf "%*s" $pad ""  # left padding

    local i=0
    for w in "${words[@]}"; do
      local c=${colors[$(( i % ${#colors[@]} ))]}
      echo -ne "${c}${w}${reset} "
      ((i++))
    done
    echo ""
  }

  echo -e "${colors[0]}================================================================${reset}"
  multicolor_center "Mega Kali & Parrot OS Tools Installer"
  multicolor_center "(500+ Tools Included)"
  echo -e "${colors[1]}----------------------------------------------------------------${reset}"
  multicolor_center "Developed by Arun Kushwah"
  multicolor_center "SMN-Arun-Kushwah-5-Ji"
  echo -e "${colors[2]}----------------------------------------------------------------${reset}"
  multicolor_center "[SMN]  = Shri Man Narayan / Narayani"
  multicolor_center "[Name] = Arun Kushwah"
  multicolor_center "[5]    = Family Members"
  multicolor_center "[Ji]   = Respect Ke Liye"
  multicolor_center "[AKJI] = Arun Kushwah Ji"
  echo -e "${colors[3]}----------------------------------------------------------------${reset}"
  multicolor_center "}=[|:|[_SMN_AKJI_5_]|:|]~>"
  echo -e "${colors[4]}================================================================${reset}"
  echo ""
}

# ------------------- Kali Tools -------------------
declare -A kali_tools=(
  ["Information Gathering"]="kali-linux-information-gathering nmap dnsenum theharvester maltego dnsrecon recon-ng masscan netdiscover arp-scan"
  ["Vulnerability Analysis"]="kali-linux-vulnerability-analysis nikto openvas wapiti sqlmap wpscan"
  ["Wireless Attacks"]="kali-linux-wireless aircrack-ng reaver wifite bully fern-wifi-cracker"
  ["Exploitation Tools"]="kali-linux-exploitation metasploit-framework armitage beef-xss exploitdb"
  ["Password Attacks"]="kali-linux-passwords john hydra hashcat medusa"
  ["Forensics"]="kali-linux-forensics autopsy sleuthkit volatility bulk-extractor"
  ["Reverse Engineering"]="kali-linux-reverse-engineering gdb radare2 apktool dex2jar jd-gui"
  ["Reporting Tools"]="kali-linux-reporting dradis faraday"
  ["Hardware Hacking"]="kali-linux-hardware usbutils"
  ["Stress Testing"]="kali-linux-stress-testing slowloris hping3"
  ["Sniffing & Spoofing"]="kali-linux-sdr wireshark ettercap mitmproxy"
  ["Maintainers Tools"]="kali-linux-maintainers-tools"
  ["Social Engineering"]="kali-linux-social-engineering set social-engineer-toolkit"
  ["Top 10 Tools"]="aircrack-ng burpsuite metasploit nmap wireshark sqlmap john hydra hashcat"
)

kali_extra_packages=(
  "masscan" "netdiscover" "arp-scan" "wpscan" "fern-wifi-cracker" "exploitdb" "medusa" "bulk-extractor" "dex2jar" "jd-gui"
  "slowloris" "hping3" "ettercap" "mitmproxy" "usbutils" "set"
)

# ------------------- Parrot Tools -------------------
declare -A parrot_tools=(
  ["Information Gathering"]="parrot-tools-info nmap dnsenum theharvester maltego dnsrecon recon-ng masscan netdiscover arp-scan"
  ["Vulnerability Analysis"]="parrot-tools-vuln nikto openvas wapiti sqlmap wpscan"
  ["Wireless Attacks"]="parrot-tools-wireless aircrack-ng reaver wifite bully fern-wifi-cracker"
  ["Exploitation Tools"]="parrot-tools-exploitation metasploit-framework armitage beef-xss exploitdb"
  ["Password Attacks"]="parrot-tools-passwords john hydra hashcat medusa"
  ["Forensics"]="parrot-tools-forensics autopsy sleuthkit volatility bulk-extractor"
  ["Reverse Engineering"]="parrot-tools-reverse-engineering gdb radare2 apktool dex2jar jd-gui"
  ["Reporting Tools"]="parrot-tools-reporting dradis faraday"
  ["Hardware Hacking"]="parrot-tools-hardware usbutils"
  ["Stress Testing"]="parrot-tools-stress-testing slowloris hping3"
  ["Sniffing & Spoofing"]="parrot-tools-sdr wireshark ettercap mitmproxy"
  ["Maintainers Tools"]="parrot-tools-maintainers-tools"
  ["Social Engineering"]="parrot-tools-social-engineering set social-engineer-toolkit"
  ["Top 10 Tools"]="aircrack-ng burpsuite metasploit nmap wireshark sqlmap john hydra hashcat"
)

parrot_extra_packages=(
  "masscan" "netdiscover" "arp-scan" "wpscan" "fern-wifi-cracker" "exploitdb" "medusa" "bulk-extractor" "dex2jar" "jd-gui"
  "slowloris" "hping3" "ettercap" "mitmproxy" "usbutils" "set"
)

# ---------------- Combine Tools ----------------
declare -A combined_tools
combine_tools() {
  combined_tools=()
  for key in "${!kali_tools[@]}"; do
    combined_tools["$key"]="${kali_tools[$key]}"
  done
  for key in "${!parrot_tools[@]}"; do
    if [[ -v combined_tools[$key] ]]; then
      existing="${combined_tools[$key]}"
      new="${parrot_tools[$key]}"
      merged=$(echo -e "$existing\n$new" | tr ' ' '\n' | sort -u | tr '\n' ' ')
      combined_tools[$key]="$merged"
    else
      combined_tools[$key]="${parrot_tools[$key]}"
    fi
  done
}

# ---------------- Installer ----------------
install_tools() {
  local os="$1"
  local category="$2"
  local packages="$3"

  echo -e "\033[1;35m Installing $category packages for $os... \033[0m"

  if command -v apt &>/dev/null; then
    sudo apt update
    sudo apt install -y $packages
  elif command -v pkg &>/dev/null; then
    pkg update -y
    pkg install -y $packages
  else
    echo -e "\033[1;31m No supported package manager found! \033[0m"
    return
  fi

  echo -e "\033[1;32m $category installation for $os completed! \033[0m"
  read -p "Press Enter to continue..."
}

# ---------------- Category Selector ----------------
select_category() {
  local os="$1"
  local -n tools_ref="$2"

  while true; do
    print_banner
    echo "Selected OS: $os"
    echo "Select Tool Category to install:"
    local i=1
    local categories=()
    for cat in "${!tools_ref[@]}"; do
      echo "$i) $cat"
      categories+=("$cat")
      ((i++))
    done
    echo "$i) Back to OS selection"
    echo "================================================================"
    read -p "Choice: " choice

    if [[ "$choice" -ge 1 && "$choice" -le "${#categories[@]}" ]]; then
      local cat_name="${categories[$((choice-1))]}"
      install_tools "$os" "$cat_name" "${tools_ref[$cat_name]}"
    elif [[ "$choice" -eq $i ]]; then
      break
    else
      echo -e "\033[1;31m Invalid option! Try again. \033[0m"
      sleep 1
    fi
  done
}

# ---------------- Main Menu ----------------
while true; do
  print_banner
  echo "Select Operating System tools to install:"
  echo "1) Kali Linux"
  echo "2) Parrot OS"
  echo "3) OS Linux (Kali + Parrot combined)"
  echo "4) Exit"
  echo "================================================================"
  read -p "Choice: " os_choice

  case $os_choice in
    1)
      kali_tools["Extra Kali Packages"]="${kali_extra_packages[*]}"
      select_category "Kali Linux" kali_tools
      ;;
    2)
      parrot_tools["Extra Parrot Packages"]="${parrot_extra_packages[*]}"
      select_category "Parrot OS" parrot_tools
      ;;
    3)
      combine_tools
      select_category "OS Linux (Combined)" combined_tools
      ;;
    4)
      echo -e "\033[1;32m Exiting. Happy hacking! \033[0m"
      exit 0
      ;;
    *)
      echo -e "\033[1;31m Invalid option! Try again. \033[0m"
      sleep 1
      ;;
  esac
done
